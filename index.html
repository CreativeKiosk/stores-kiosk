<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Stores Kiosk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
      body {{
        margin: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: #0f172a;
        color: #fff;
      }}
      * {{
        box-sizing: border-box;
      }}
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const {{ useState, useEffect }} = React;

      const EMPLOYEES = [{"id": 1, "name": "Sheldon", "pin": "101"}, {"id": 2, "name": "Haydon", "pin": "202"}, {"id": 3, "name": "Mark", "pin": "303"}, {"id": 4, "name": "Bailey", "pin": "404"}, {"id": 5, "name": "Ed", "pin": "505"}, {"id": 6, "name": "Brendan", "pin": "606"}];

      const INACTIVITY_TIMEOUT_MS = 2 * 60 * 1000;

      const VIEWS = {{
        SELECT_EMPLOYEE: "SELECT_EMPLOYEE",
        ENTER_PIN: "ENTER_PIN",
        MENU: "MENU",
        TAKE_STOCK: "TAKE_STOCK",
        RETURN_STOCK: "RETURN_STOCK",
        TOOL_OUT: "TOOL_OUT",
        TOOL_IN: "TOOL_IN",
        PUNCH_IN: "PUNCH_IN",
        DONE: "DONE",
      }};

      function App() {{
        const [employees] = useState(EMPLOYEES);
        const [selectedEmployee, setSelectedEmployee] = useState(null);
        const [view, setView] = useState(VIEWS.SELECT_EMPLOYEE);
        const [pinInput, setPinInput] = useState("");
        const [message, setMessage] = useState("");
        const [error, setError] = useState("");
        const [lastActivity, setLastActivity] = useState(Date.now());

        const [stockItem, setStockItem] = useState("");
        const [stockQty, setStockQty] = useState("");
        const [toolName, setToolName] = useState("");

        useEffect(() => {{
          const timer = setInterval(() => {{
            if (selectedEmployee && Date.now() - lastActivity > INACTIVITY_TIMEOUT_MS) {{
              handleLogout();
            }}
          }}, 5000);
          return () => clearInterval(timer);
        }}, [selectedEmployee, lastActivity]);

        const markActivity = () => setLastActivity(Date.now());

        const handleSelectEmployee = (emp) => {{
          markActivity();
          setSelectedEmployee(emp);
          setPinInput("");
          setError("");
          setView(VIEWS.ENTER_PIN);
        }};

        const handlePinKey = (key) => {{
          markActivity();
          if (key === "DEL") {{
            setPinInput((prev) => prev.slice(0, -1));
          }} else if (key === "CLR") {{
            setPinInput("");
          }} else {{
            setPinInput((prev) => (prev.length < 3 ? prev + key : prev));
          }}
        }};

        const handlePinSubmit = () => {{
          markActivity();
          if (!selectedEmployee) return;
          if (pinInput === selectedEmployee.pin) {{
            setError("");
            setView(VIEWS.MENU);
          }} else {{
            setError("Incorrect PIN. Try again.");
            setPinInput("");
          }}
        }};

        const handleLogout = () => {{
          setSelectedEmployee(null);
          setPinInput("");
          setError("");
          setMessage("");
          setStockItem("");
          setStockQty("");
          setToolName("");
          setView(VIEWS.SELECT_EMPLOYEE);
        }};

        const fakeSubmit = (text) => {{
          markActivity();
          setMessage(text);
          setError("");
          setStockItem("");
          setStockQty("");
          setToolName("");
          setView(VIEWS.DONE);
        }};

        const handleTakeStockSubmit = () => {{
          if (!stockItem || !stockQty) {{
            setError("Please enter item and quantity.");
            return;
          }}
          fakeSubmit(`Recorded: ${{selectedEmployee.name}} took ${{stockQty}} of "${{stockItem}}"`);
        }};

        const handleReturnStockSubmit = () => {{
          if (!stockItem || !stockQty) {{
            setError("Please enter item and quantity.");
            return;
          }}
          fakeSubmit(`Recorded: ${{selectedEmployee.name}} returned ${{stockQty}} of "${{stockItem}}"`);
        }};

        const handleToolOutSubmit = () => {{
          if (!toolName) {{
            setError("Please enter the tool name.");
            return;
          }}
          fakeSubmit(`Recorded: ${{selectedEmployee.name}} signed OUT tool "${{toolName}}"`);
        }};

        const handleToolInSubmit = () => {{
          if (!toolName) {{
            setError("Please enter the tool name.");
            return;
          }}
          fakeSubmit(`Recorded: ${{selectedEmployee.name}} signed IN tool "${{toolName}}"`);
        }};

        const handlePunchInSubmit = () => {{
          const now = new Date();
          fakeSubmit(`Recorded: ${{selectedEmployee.name}} punched in at ${{now.toLocaleTimeString()}}`);
        }};

        const Layout = ({{ children }}) => (
          <div
            className="min-h-screen"
            style={{{ backgroundColor: "#0f172a", color: "white" }}}
            onClick={markActivity}
            onTouchStart={markActivity}
          >
            <div style={{{ maxWidth: 480, margin: "0 auto", padding: 16 }}}>
              <h1 style={{{ textAlign: "center", fontSize: 28, fontWeight: "bold", marginBottom: 12 }}}>
                Stores Kiosk
              </h1>
              {{selectedEmployee && (
                <div style={{{ display: "flex", justifyContent: "space-between", fontSize: 12, marginBottom: 8 }}}>
                  <span>Logged in as: {{selectedEmployee.name}}</span>
                  <button
                    onClick={handleLogout}
                    style={{{ background: "none", border: "none", color: "#fca5a5", textDecoration: "underline", cursor: "pointer" }}}
                  >
                    Log out
                  </button>
                </div>
              )}}
              {{error && (
                <div style={{{ backgroundColor: "#b91c1c", padding: 8, borderRadius: 8, fontSize: 14, textAlign: "center", marginBottom: 8 }}}>
                  {{error}}
                </div>
              )}}
              {{message && view === VIEWS.DONE && (
                <div style={{{ backgroundColor: "#15803d", padding: 8, borderRadius: 8, fontSize: 14, textAlign: "center", marginBottom: 8 }}}>
                  {{message}}
                </div>
              )}}
              <div style={{{ backgroundColor: "#1f2937", borderRadius: 16, padding: 16, boxShadow: "0 10px 25px rgba(0,0,0,0.4)" }}}>
                {{children}}
              </div>
            </div>
          </div>
        );

        const EmployeeSelect = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 12 }}}>Select your name</h2>
            <div style={{{ maxHeight: 420, overflowY: "auto" }}}>
              {{employees.map(emp => (
                <button
                  key={emp.id}
                  onClick={{() => handleSelectEmployee(emp)}}
                  style={{{ display: "block", width: "100%", textAlign: "left", marginBottom: 8, padding: "10px 12px",
                           borderRadius: 12, border: "none", backgroundColor: "#374151", color: "white",
                           fontSize: 18, cursor: "pointer" }}}
                >
                  {{emp.name}}
                </button>
              ))}}
            </div>
          </div>
        );

        const PinPad = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 8 }}}>Enter your 3-digit PIN</h2>
            <div style={{{ textAlign: "center", fontSize: 32, letterSpacing: "0.4em", marginBottom: 12, fontFamily: "monospace" }}}>
              {{pinInput.padEnd(3, "‚óè")}}
            </div>
            <div style={{{ display: "grid", gridTemplateColumns: "repeat(3, 1fr)", gap: 8 }}}>
              {{["1","2","3","4","5","6","7","8","9","CLR","0","DEL"].map(key => (
                <button
                  key={key}
                  onClick={{() => handlePinKey(key)}}
                  style={{{ padding: "12px 0", borderRadius: 12, border: "none", backgroundColor: "#374151",
                           color: "white", fontSize: 20, fontWeight: "bold", cursor: "pointer" }}}
                >
                  {{key}}
                </button>
              ))}}
            </div>
            <button
              onClick={handlePinSubmit}
              style={{{ marginTop: 10, width: "100%", padding: "10px 0", borderRadius: 12, border: "none",
                       backgroundColor: "#16a34a", color: "white", fontSize: 18, fontWeight: "bold", cursor: "pointer" }}}
            >
              Enter
            </button>
          </div>
        );

        const btnStyle = (bg) => {{
          return {{
            width: "100%",
            padding: "14px 0",
            borderRadius: 12,
            border: "none",
            backgroundColor: bg,
            color: "white",
            fontSize: 18,
            fontWeight: "bold",
            cursor: "pointer",
            marginBottom: 4
          }};
        }};

        const Menu = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 12 }}}>What do you want to do?</h2>
            <div style={{{ display: "grid", gap: 8 }}}>
              <button style={btnStyle("#3b82f6")} onClick={{() => setView(VIEWS.TAKE_STOCK)}}>Take Stock</button>
              <button style={btnStyle("#f59e0b")} onClick={{() => setView(VIEWS.RETURN_STOCK)}}>Return Stock</button>
              <button style={btnStyle("#6366f1")} onClick={{() => setView(VIEWS.TOOL_OUT)}}>Tool Sign Out</button>
              <button style={btnStyle("#8b5cf6")} onClick={{() => setView(VIEWS.TOOL_IN)}}>Tool Sign In</button>
              <button style={btnStyle("#22c55e")} onClick={{() => setView(VIEWS.PUNCH_IN)}}>Punch In</button>
            </div>
          </div>
        );

        const BackButton = () => (
          <button
            onClick={{() => {{ setError(""); setMessage(""); setView(VIEWS.MENU); }}}}
            style={{{ marginTop: 10, width: "100%", padding: "8px 0", borderRadius: 12, border: "none",
                     background: "none", color: "#e5e7eb", textDecoration: "underline", cursor: "pointer", fontSize: 14 }}}
          >
            Back to menu
          </button>
        );

        const inputStyle = {{
          width: "100%",
          padding: "10px 12px",
          borderRadius: 10,
          border: "none",
          marginBottom: 10,
          backgroundColor: "#374151",
          color: "white",
          fontSize: 16
        }};

        const TakeStockForm = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 12 }}}>Take Stock</h2>
            <input
              placeholder="Item name or code"
              value={stockItem}
              onChange={{e => setStockItem(e.target.value)}}
              style={inputStyle}
            />
            <input
              placeholder="Quantity"
              type="number"
              min="1"
              value={stockQty}
              onChange={{e => setStockQty(e.target.value)}}
              style={inputStyle}
            />
            <button style={btnStyle("#3b82f6")} onClick={handleTakeStockSubmit}>Confirm</button>
            <BackButton />
          </div>
        );

        const ReturnStockForm = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 12 }}}>Return Stock</h2>
            <input
              placeholder="Item name or code"
              value={stockItem}
              onChange={{e => setStockItem(e.target.value)}}
              style={inputStyle}
            />
            <input
              placeholder="Quantity"
              type="number"
              min="1"
              value={stockQty}
              onChange={{e => setStockQty(e.target.value)}}
              style={inputStyle}
            />
            <button style={btnStyle("#f59e0b")} onClick={handleReturnStockSubmit}>Confirm</button>
            <BackButton />
          </div>
        );

        const ToolOutForm = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 12 }}}>Tool Sign Out</h2>
            <input
              placeholder="Tool name or ID"
              value={toolName}
              onChange={{e => setToolName(e.target.value)}}
              style={inputStyle}
            />
            <button style={btnStyle("#6366f1")} onClick={handleToolOutSubmit}>Confirm</button>
            <BackButton />
          </div>
        );

        const ToolInForm = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 12 }}}>Tool Sign In</h2>
            <input
              placeholder="Tool name or ID"
              value={toolName}
              onChange={{e => setToolName(e.target.value)}}
              style={inputStyle}
            />
            <button style={btnStyle("#8b5cf6")} onClick={handleToolInSubmit}>Confirm</button>
            <BackButton />
          </div>
        );

        const PunchInView = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 20, marginBottom: 12 }}}>Punch In</h2>
            <p style={{{ textAlign: "center", fontSize: 14, marginBottom: 12, color: "#e5e7eb" }}}>
              This will record the time you arrived.
            </p>
            <button style={btnStyle("#22c55e")} onClick={handlePunchInSubmit}>Punch In</button>
            <BackButton />
          </div>
        );

        const DoneView = () => (
          <div>
            <h2 style={{{ textAlign: "center", fontSize: 22, marginBottom: 12 }}}>Done</h2>
            <p style={{{ textAlign: "center", fontSize: 16, marginBottom: 16 }}}>
              {{message || "Your action has been recorded."}}
            </p>
            <button
              onClick={{() => {{ setMessage(""); setView(VIEWS.MENU); }}}}
              style={btnStyle("#374151")}
            >
              Back to menu
            </button>
          </div>
        );

        let content;
        if (view === VIEWS.SELECT_EMPLOYEE) content = <EmployeeSelect />;
        else if (view === VIEWS.ENTER_PIN) content = <PinPad />;
        else if (view === VIEWS.MENU) content = <Menu />;
        else if (view === VIEWS.TAKE_STOCK) content = <TakeStockForm />;
        else if (view === VIEWS.RETURN_STOCK) content = <ReturnStockForm />;
        else if (view === VIEWS.TOOL_OUT) content = <ToolOutForm />;
        else if (view === VIEWS.TOOL_IN) content = <ToolInForm />;
        else if (view === VIEWS.PUNCH_IN) content = <PunchInView />;
        else if (view === VIEWS.DONE) content = <DoneView />;

        return <Layout>{{content}}</Layout>;
      }}

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
